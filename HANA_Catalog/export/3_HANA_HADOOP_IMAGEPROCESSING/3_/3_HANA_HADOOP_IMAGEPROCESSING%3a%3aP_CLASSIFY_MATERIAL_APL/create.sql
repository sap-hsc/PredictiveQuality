CREATE PROCEDURE "3_HANA_HADOOP_IMAGEPROCESSING"."3_HANA_HADOOP_IMAGEPROCESSING::P_CLASSIFY_MATERIAL_APL" ( ) 
	LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   DEFAULT SCHEMA 3_HANA_HADOOP_IMAGEPROCESSING
   --READS SQL DATA 
   AS
BEGIN
	DROP TABLE "3_HANA_HADOOP_IMAGEPROCESSING"."DATA_MODEL_TBL_2";
	CREATE COLUMN TABLE "3_HANA_HADOOP_IMAGEPROCESSING"."DATA_MODEL_TBL_2" AS (
			SELECT *
			FROM "_SYS_BIC"."3_HANA_HADOOP_IMAGEPROCESSING/CV_DATA_MODEL" 
	);
	
   t_result=
			-- Automated Analytics - Registered Version 9.3.0.5 - Copyright 2017 SAP SE or an SAP affiliate company. All rights reserved. - Model built in 9.3.0.5 - Model Name is QA_PASS_FKOM - Model Version is 2
			SELECT MATERIAL_ID, "rr_QA_PASS", CAST((CASE 
			WHEN "rr_QA_PASS" < -1.5000030991521496e0 THEN 0.0e0
			WHEN "rr_QA_PASS" <= -1.0030862775464167e-3 THEN 0.0e0
			WHEN "rr_QA_PASS" <= -3.0991521496797264e-6 THEN  ( 4.1667203115375862e-1*"rr_QA_PASS"+4.1795799668772828e-4 ) 
			WHEN "rr_QA_PASS" <= -1.1281975532885688e-6 THEN  ( 2.114034830784984e2*"rr_QA_PASS"+1.0718382256991767e-3 ) 
			WHEN "rr_QA_PASS" <= -1.1262246257646537e-6 THEN  ( 2.1098088751580942e8*"rr_QA_PASS"+2.3802895441932029e2 ) 
			WHEN "rr_QA_PASS" <= -5.2732348309483494e-7 THEN  ( 6.9502288498635183e5*"rr_QA_PASS"+1.1998352218749573e0 ) 
			WHEN "rr_QA_PASS" <= 2.4671822302542611e-6 THEN  ( 2.7800915399454025e4*"rr_QA_PASS"+8.4799340887499841e-1 ) 
			WHEN "rr_QA_PASS" <= 2.4704415665650111e-6 THEN  ( 2.5542009802861378e7*"rr_QA_PASS"-6.2100209377266452e1 ) 
			WHEN "rr_QA_PASS" <= 5.7265183861940279e-6 THEN  ( 2.5593171767617815e1*"rr_QA_PASS"+9.9977010689797841e-1 ) 
			WHEN "rr_QA_PASS" <= 1.0057265658836453e-3 THEN  ( 8.3333329375203408e-2*"rr_QA_PASS"+9.999161894568237e-1 ) 
			WHEN "rr_QA_PASS" > 1.0057265658836453e-3 THEN 1.0e0
			ELSE 1.0e0
			END) AS DOUBLE) AS PROBA0 
			FROM 
			(
			SELECT MATERIAL_ID, 
			CAST( (  CAST( (CASE 
			WHEN ( "SUPPLIER" IS NULL OR "SUPPLIER" = ''  ) THEN -2.013221739687334e-7
			WHEN "SUPPLIER" IN('PV DynaPlast Inc')  THEN 4.0962688073400075e-7
			ELSE -2.013221739687334e-7
			END)  AS DOUBLE)+
			 CAST( (CASE 
			WHEN ( "PRESSDUR" IS NULL ) THEN -1.3356231912338253e-8
			WHEN "PRESSDUR" <= 2.6e1 THEN -4.3384158165958936e-7
			WHEN "PRESSDUR" <= 3.0995000064374015e1 THEN  ( 4.6451982089222195e-8*"PRESSDUR"-1.6415931159561636e-6 ) 
			WHEN "PRESSDUR" <= 3.1000000000000998e1 THEN  ( 1.4115293073140852e-5*"PRESSDUR"-4.3770532363874822e-4 ) 
			WHEN "PRESSDUR" <= 3.187468030690637e1 THEN  ( 1.26873707885538e-7*"PRESSDUR"-4.0643233158224175e-6 ) 
			WHEN "PRESSDUR" <= 3.3000000000001002e1 THEN  ( 9.5039000353893179e-8*"PRESSDUR"-3.0496021905767118e-6 ) 
			WHEN "PRESSDUR" <= 3.3007000000333484e1 THEN  ( 7.8572985370937964e-6*"PRESSDUR"-2.5920416690298803e-4 ) 
			WHEN "PRESSDUR" <= 4.0000000000001002e1 THEN  ( 4.6451982089222214e-8*"PRESSDUR"-1.3915546593226032e-6 ) 
			WHEN "PRESSDUR" > 4.0e1 THEN 4.6652462424628533e-7
			ELSE 4.6652462424628533e-7
			END) AS DOUBLE)+
			 CAST( (CASE 
			WHEN ( "RASTERMAX63" IS NULL ) THEN -6.8507009875417258e-8
			WHEN "RASTERMAX63" <= 5.1372551918029785e-1 THEN 1.3843525282547028e-6
			WHEN "RASTERMAX63" <= 6.6259610046178163e-1 THEN  ( -4.9213831021401034e-6*"RASTERMAX63"+3.9125926174135065e-6 ) 
			WHEN "RASTERMAX63" <= 6.6274511814217429e-1 THEN  ( -2.2093227872953917e-3*"RASTERMAX63"+1.4645403668861006e-3 ) 
			WHEN "RASTERMAX63" <= 6.681242815352294e-1 THEN  ( -6.5989389389351446e-5*"RASTERMAX63"+4.4056620874901926e-5 ) 
			WHEN "RASTERMAX63" <= 6.8980394005875445e-1 THEN  ( -8.680954522049241e-6*"RASTERMAX63"+5.7674640033156411e-6 ) 
			WHEN "RASTERMAX63" <= 7.0588237047295432e-1 THEN  ( 5.2171966573054933e-6*"RASTERMAX63"-3.8195354397173877e-6 ) 
			WHEN "RASTERMAX63" <= 7.0596080184455379e-1 THEN  ( 1.0342829928539298e-3*"RASTERMAX63"-7.3021893903059128e-4 ) 
			WHEN "RASTERMAX63" <= 7.8431373834709983e-1 THEN  ( -4.9213831021401085e-6*"RASTERMAX63"+3.4186154986470356e-6 ) 
			WHEN "RASTERMAX63" > 7.8431373834609985e-1 THEN -4.4129288002579752e-7
			ELSE -4.4129288002579752e-7
			END) AS DOUBLE)+
			 CAST( (CASE 
			WHEN ( "YCOORD5" IS NULL ) THEN -5.6340831272879599e-7
			WHEN "YCOORD5" <= 3.6e2 THEN 2.7205030726109811e-6
			WHEN "YCOORD5" <= 3.8797200036048991e2 THEN  ( -1.1313697595443981e-8*"YCOORD5"+6.7934342069391688e-6 ) 
			WHEN "YCOORD5" <= 3.8800000000000102e2 THEN  ( -3.0790523297298873e-5*"YCOORD5"+1.1948264952118554e-2 ) 
			WHEN "YCOORD5" <= 3.8821100001002299e2 THEN  ( -4.0957057937719729e-6*"YCOORD5"+1.5906757607500328e-3 ) 
			WHEN "YCOORD5" <= 5.9900000000000102e2 THEN  ( -1.1313697595443983e-8*"YCOORD5"+5.0698206600743027e-6 ) 
			WHEN "YCOORD5" > 5.99e2 THEN -1.7070841995966425e-6
			ELSE -1.7070841995966425e-6
			END) AS DOUBLE)+
			 CAST( (CASE 
			WHEN ( "MAXVAL5" IS NULL ) THEN -3.7622753387819029e-7
			WHEN "MAXVAL5" <= 6.0784316062927246e-1 THEN -8.1619863436867536e-7
			WHEN "MAXVAL5" <= 7.6454903566236065e-1 THEN  ( 3.838523605138205e-6*"MAXVAL5"-3.1494189546057995e-6 ) 
			WHEN "MAXVAL5" <= 7.6470589637856345e-1 THEN  ( 3.8205890357630675e-3*"MAXVAL5"-2.9212423423848953e-3 ) 
			WHEN "MAXVAL5" <= 7.6494119049336173e-1 THEN  ( 2.5483059847555486e-3*"MAXVAL5"-1.9483199914181492e-3 ) 
			WHEN "MAXVAL5" <= 1.0000000000010001e0 THEN  ( 3.8385236051382033e-6*"MAXVAL5"-1.9520225165868601e-6 ) 
			WHEN "MAXVAL5" > 1.0e0 THEN 1.8865010885513437e-6
			ELSE 1.8865010885513437e-6
			END) AS DOUBLE) )  AS DOUBLE) AS "rr_QA_PASS" FROM --DATA_MODEL_TBL_FILTERED
			--"_SYS_BIC"."3_HANA_HADOOP_IMAGEPROCESSING/CV_DATA_MODEL"
			DATA_MODEL_TBL_2
			) TMPTABLE0
	;
   
   
   	--DROP TABLE  "3_HANA_HADOOP_IMAGEPROCESSING"."PRED_MODEL_RESULTS_2";
   	--TRUNCATE TABLE "3_HANA_HADOOP_IMAGEPROCESSING"."PRED_MODEL_RESULTS_2";
	INSERT INTO "3_HANA_HADOOP_IMAGEPROCESSING"."PRED_MODEL_RESULTS_2" (
		SELECT * FROM :t_result
	);
END